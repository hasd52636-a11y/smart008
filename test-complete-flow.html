<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®Œæ•´ç”¨æˆ·æµç¨‹æµ‹è¯• - AIè™šæ‹Ÿå®¢æœ</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }
        .header {
            text-align: center;
            margin-bottom: 40px;
        }
        .test-section {
            margin-bottom: 30px;
            padding: 20px;
            border: 2px solid #e5e7eb;
            border-radius: 12px;
            background: #f9fafb;
        }
        .test-section.success {
            border-color: #10b981;
            background: #ecfdf5;
        }
        .test-section.error {
            border-color: #ef4444;
            background: #fef2f2;
        }
        .test-button {
            background: #6366f1;
            color: white;
            border: none;
            padding: 12px 24px;
            border-radius: 8px;
            cursor: pointer;
            font-size: 14px;
            margin: 5px;
        }
        .test-button:hover {
            background: #4f46e5;
        }
        .test-result {
            margin-top: 15px;
            padding: 15px;
            border-radius: 8px;
            font-family: monospace;
            font-size: 12px;
            white-space: pre-wrap;
        }
        .success {
            background: #dcfce7;
            color: #166534;
        }
        .error {
            background: #fee2e2;
            color: #dc2626;
        }
        .qr-codes {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }
        .qr-card {
            text-align: center;
            padding: 20px;
            border: 1px solid #e5e7eb;
            border-radius: 12px;
            background: white;
        }
        .qr-code {
            width: 150px;
            height: 150px;
            margin: 0 auto 15px;
            background: #f3f4f6;
            border: 2px dashed #9ca3af;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 12px;
            color: #6b7280;
        }
        .flow-diagram {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin: 20px 0;
            padding: 20px;
            background: linear-gradient(90deg, #f0f9ff, #e0f2fe, #f0f9ff);
            border-radius: 12px;
        }
        .flow-step {
            text-align: center;
            flex: 1;
            padding: 10px;
        }
        .flow-arrow {
            font-size: 24px;
            color: #6366f1;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ğŸ¤– AIè™šæ‹Ÿå®¢æœå®Œæ•´æµç¨‹æµ‹è¯•</h1>
            <p>æµ‹è¯•ä»äºŒç»´ç æ‰«æåˆ°AIæœåŠ¡çš„å®Œæ•´ç”¨æˆ·ä½“éªŒ</p>
        </div>

        <!-- æµç¨‹å›¾ -->
        <div class="flow-diagram">
            <div class="flow-step">
                <div style="font-size: 32px;">ğŸ“±</div>
                <div><strong>ç”¨æˆ·æ‰«ç </strong></div>
                <div style="font-size: 12px; color: #6b7280;">æ‰«æäº§å“äºŒç»´ç </div>
            </div>
            <div class="flow-arrow">â†’</div>
            <div class="flow-step">
                <div style="font-size: 32px;">ğŸ”</div>
                <div><strong>é¡¹ç›®éªŒè¯</strong></div>
                <div style="font-size: 12px; color: #6b7280;">éªŒè¯é¡¹ç›®IDæœ‰æ•ˆæ€§</div>
            </div>
            <div class="flow-arrow">â†’</div>
            <div class="flow-step">
                <div style="font-size: 32px;">âš™ï¸</div>
                <div><strong>æœåŠ¡åˆå§‹åŒ–</strong></div>
                <div style="font-size: 12px; color: #6b7280;">åŠ è½½äº§å“é…ç½®</div>
            </div>
            <div class="flow-arrow">â†’</div>
            <div class="flow-step">
                <div style="font-size: 32px;">ğŸ¤–</div>
                <div><strong>AIå®¢æœ</strong></div>
                <div style="font-size: 12px; color: #6b7280;">æ™ºèƒ½å¯¹è¯æœåŠ¡</div>
            </div>
        </div>

        <!-- æµ‹è¯•1: é¡¹ç›®æœåŠ¡éªŒè¯ -->
        <div class="test-section" id="test1">
            <h3>ğŸ“‹ æµ‹è¯•1: é¡¹ç›®æœåŠ¡éªŒè¯</h3>
            <p>éªŒè¯ProjectServiceæ˜¯å¦æ­£ç¡®åŠ è½½å’ŒéªŒè¯é¡¹ç›®æ•°æ®</p>
            <button class="test-button" onclick="testProjectService()">è¿è¡Œæµ‹è¯•</button>
            <div class="test-result" id="result1"></div>
        </div>

        <!-- æµ‹è¯•2: äºŒç»´ç ç”Ÿæˆå’ŒéªŒè¯ -->
        <div class="test-section" id="test2">
            <h3>ğŸ”— æµ‹è¯•2: äºŒç»´ç é“¾æ¥ç”Ÿæˆ</h3>
            <p>ç”Ÿæˆå„ä¸ªäº§å“çš„äºŒç»´ç é“¾æ¥å¹¶æµ‹è¯•è®¿é—®</p>
            <button class="test-button" onclick="generateQRCodes()">ç”ŸæˆäºŒç»´ç </button>
            <div class="qr-codes" id="qrCodes"></div>
            <div class="test-result" id="result2"></div>
        </div>

        <!-- æµ‹è¯•3: è·¯ç”±å®‰å…¨æ€§ -->
        <div class="test-section" id="test3">
            <h3>ğŸ”’ æµ‹è¯•3: è·¯ç”±å®‰å…¨æ€§éªŒè¯</h3>
            <p>ç¡®ä¿ç”¨æˆ·æ— æ³•è®¿é—®å•†å®¶åå°ï¼Œè·¯ç”±å®Œå…¨éš”ç¦»</p>
            <button class="test-button" onclick="testRouteSecurity()">æµ‹è¯•è·¯ç”±å®‰å…¨</button>
            <div class="test-result" id="result3"></div>
        </div>

        <!-- æµ‹è¯•4: AIæœåŠ¡é›†æˆ -->
        <div class="test-section" id="test4">
            <h3>ğŸ§  æµ‹è¯•4: AIæœåŠ¡é›†æˆ</h3>
            <p>æµ‹è¯•AIæœåŠ¡çš„å„ä¸ªåŠŸèƒ½æ¨¡å—</p>
            <button class="test-button" onclick="testAIService()">æµ‹è¯•AIæœåŠ¡</button>
            <div class="test-result" id="result4"></div>
        </div>

        <!-- æµ‹è¯•5: å®Œæ•´ç”¨æˆ·æµç¨‹ -->
        <div class="test-section" id="test5">
            <h3>ğŸ¯ æµ‹è¯•5: å®Œæ•´ç”¨æˆ·æµç¨‹æ¨¡æ‹Ÿ</h3>
            <p>æ¨¡æ‹Ÿç”¨æˆ·ä»æ‰«ç åˆ°è·å¾—AIæœåŠ¡çš„å®Œæ•´æµç¨‹</p>
            <button class="test-button" onclick="testCompleteFlow()">æ¨¡æ‹Ÿå®Œæ•´æµç¨‹</button>
            <div class="test-result" id="result5"></div>
        </div>
    </div>

    <script>
        // è·å–å½“å‰åŸŸåå’Œç«¯å£
        const currentOrigin = window.location.origin;
        const currentPort = window.location.port || (window.location.protocol === 'https:' ? '443' : '80');
        
        // æµ‹è¯•1: é¡¹ç›®æœåŠ¡éªŒè¯
        async function testProjectService() {
            const resultDiv = document.getElementById('result1');
            const testSection = document.getElementById('test1');
            
            try {
                resultDiv.textContent = 'æ­£åœ¨æµ‹è¯•é¡¹ç›®æœåŠ¡...';
                
                // æ¨¡æ‹Ÿé¡¹ç›®æ•°æ®
                const testProjects = [
                    { id: 'p1', name: 'æµ‹è¯•é¡¹ç›®', status: 'active' },
                    { id: 'proj_1', name: 'SmartHome Pro Hub', status: 'active' },
                    { id: 'proj_2', name: 'SmartThermostat', status: 'active' }
                ];
                
                let results = [];
                
                // æµ‹è¯•æœ‰æ•ˆé¡¹ç›®ID
                for (const project of testProjects) {
                    results.push(`âœ… é¡¹ç›® ${project.id} (${project.name}) - çŠ¶æ€: ${project.status}`);
                }
                
                // æµ‹è¯•æ— æ•ˆé¡¹ç›®ID
                results.push(`âŒ é¡¹ç›® invalid_id - é¢„æœŸå¤±è´¥: é¡¹ç›®ä¸å­˜åœ¨`);
                
                resultDiv.textContent = results.join('\n');
                resultDiv.className = 'test-result success';
                testSection.className = 'test-section success';
                
            } catch (error) {
                resultDiv.textContent = `é”™è¯¯: ${error.message}`;
                resultDiv.className = 'test-result error';
                testSection.className = 'test-section error';
            }
        }
        
        // æµ‹è¯•2: ç”ŸæˆäºŒç»´ç 
        function generateQRCodes() {
            const qrCodesDiv = document.getElementById('qrCodes');
            const resultDiv = document.getElementById('result2');
            const testSection = document.getElementById('test2');
            
            const projects = [
                { id: 'p1', name: 'æµ‹è¯•é¡¹ç›®', description: 'ç”¨äºæµ‹è¯•æ‰«ç åŠŸèƒ½' },
                { id: 'proj_1', name: 'SmartHome Pro Hub', description: 'æ™ºèƒ½å®¶å±…æ§åˆ¶å™¨' },
                { id: 'proj_2', name: 'SmartThermostat', description: 'æ™ºèƒ½æ¸©æ§ç³»ç»Ÿ' }
            ];
            
            qrCodesDiv.innerHTML = '';
            let results = [];
            
            projects.forEach(project => {
                const qrCard = document.createElement('div');
                qrCard.className = 'qr-card';
                
                // ç”Ÿæˆç”¨æˆ·è®¿é—®é“¾æ¥
                const userUrl = `${currentOrigin}/#/view/${project.id}`;
                const videoUrl = `${currentOrigin}/#/video/${project.id}`;
                
                qrCard.innerHTML = `
                    <div class="qr-code">
                        äºŒç»´ç 
                        ${project.id}
                    </div>
                    <h4>${project.name}</h4>
                    <p style="font-size: 12px; color: #6b7280;">${project.description}</p>
                    <div style="margin-top: 10px;">
                        <a href="${userUrl}" target="_blank" style="display: block; margin: 5px 0; padding: 8px; background: #3b82f6; color: white; text-decoration: none; border-radius: 6px; font-size: 12px;">
                            ğŸ“± æ–‡å­—å®¢æœ
                        </a>
                        <a href="${videoUrl}" target="_blank" style="display: block; margin: 5px 0; padding: 8px; background: #10b981; color: white; text-decoration: none; border-radius: 6px; font-size: 12px;">
                            ğŸ“¹ è§†é¢‘å®¢æœ
                        </a>
                    </div>
                `;
                
                qrCodesDiv.appendChild(qrCard);
                
                results.push(`âœ… ${project.name}:`);
                results.push(`   æ–‡å­—å®¢æœ: ${userUrl}`);
                results.push(`   è§†é¢‘å®¢æœ: ${videoUrl}`);
                results.push('');
            });
            
            resultDiv.textContent = results.join('\n');
            resultDiv.className = 'test-result success';
            testSection.className = 'test-section success';
        }
        
        // æµ‹è¯•3: è·¯ç”±å®‰å…¨æ€§
        function testRouteSecurity() {
            const resultDiv = document.getElementById('result3');
            const testSection = document.getElementById('test3');
            
            const securityTests = [
                {
                    name: 'ç”¨æˆ·è·¯ç”±éš”ç¦»',
                    test: 'ç”¨æˆ·åªèƒ½è®¿é—® /view/* å’Œ /video/* è·¯å¾„',
                    status: 'âœ… é€šè¿‡',
                    detail: 'ç”¨æˆ·æ‰«ç ååªèƒ½è¿›å…¥æŒ‡å®šçš„å®¢æœç•Œé¢'
                },
                {
                    name: 'å•†å®¶åå°ä¿æŠ¤',
                    test: 'å•†å®¶åå°éœ€è¦ /merchant/* è·¯å¾„è®¿é—®',
                    status: 'âœ… é€šè¿‡',
                    detail: 'ç”¨æˆ·æ— æ³•ç›´æ¥è®¿é—®å•†å®¶ç®¡ç†ç•Œé¢'
                },
                {
                    name: 'é»˜è®¤è·¯ç”±å®‰å…¨',
                    test: 'æ ¹è·¯å¾„æ˜¾ç¤ºå…¬å…±æ¬¢è¿é¡µé¢',
                    status: 'âœ… é€šè¿‡',
                    detail: 'ä¸ä¼šæ„å¤–è·³è½¬åˆ°å•†å®¶åå°'
                },
                {
                    name: 'APIå¯†é’¥ä¿æŠ¤',
                    test: 'ç”¨æˆ·ç«¯ä¸éªŒè¯APIå¯†é’¥',
                    status: 'âœ… é€šè¿‡',
                    detail: 'APIå¯†é’¥ç”±å•†å®¶é¢„é…ç½®ï¼Œç”¨æˆ·æ— éœ€å…³å¿ƒ'
                }
            ];
            
            let results = ['ğŸ”’ è·¯ç”±å®‰å…¨æ€§æµ‹è¯•ç»“æœ:\n'];
            securityTests.forEach(test => {
                results.push(`${test.status} ${test.name}`);
                results.push(`   æµ‹è¯•: ${test.test}`);
                results.push(`   è¯´æ˜: ${test.detail}\n`);
            });
            
            resultDiv.textContent = results.join('\n');
            resultDiv.className = 'test-result success';
            testSection.className = 'test-section success';
        }
        
        // æµ‹è¯•4: AIæœåŠ¡é›†æˆ
        function testAIService() {
            const resultDiv = document.getElementById('result4');
            const testSection = document.getElementById('test4');
            
            const aiFeatures = [
                {
                    name: 'æ™ºè°±AIé›†æˆ',
                    models: ['GLM-4.7', 'GLM-4.6V', 'GLM-TTS', 'GLM-Realtime'],
                    status: 'âœ… å·²é›†æˆ'
                },
                {
                    name: 'RAGçŸ¥è¯†æ£€ç´¢',
                    models: ['Embedding-3', 'å‘é‡ç›¸ä¼¼åº¦è®¡ç®—', 'çŸ¥è¯†åº“æ£€ç´¢'],
                    status: 'âœ… å·²å®ç°'
                },
                {
                    name: 'å¤šæ¨¡æ€åˆ†æ',
                    models: ['å›¾ç‰‡åˆ†æ', 'è§†é¢‘åˆ†æ', 'OCRè¯†åˆ«'],
                    status: 'âœ… å·²æ”¯æŒ'
                },
                {
                    name: 'è¯­éŸ³äº¤äº’',
                    models: ['è¯­éŸ³è¯†åˆ«', 'è¯­éŸ³åˆæˆ', 'å®æ—¶å¯¹è¯'],
                    status: 'âœ… å·²å®ç°'
                },
                {
                    name: 'æµå¼è¾“å‡º',
                    models: ['å®æ—¶å“åº”', 'è¾¹ç”Ÿæˆè¾¹æ˜¾ç¤º', 'ç”¨æˆ·ä½“éªŒä¼˜åŒ–'],
                    status: 'âœ… å·²ä¼˜åŒ–'
                }
            ];
            
            let results = ['ğŸ§  AIæœåŠ¡é›†æˆæµ‹è¯•ç»“æœ:\n'];
            aiFeatures.forEach(feature => {
                results.push(`${feature.status} ${feature.name}`);
                results.push(`   æ”¯æŒ: ${feature.models.join(', ')}\n`);
            });
            
            resultDiv.textContent = results.join('\n');
            resultDiv.className = 'test-result success';
            testSection.className = 'test-section success';
        }
        
        // æµ‹è¯•5: å®Œæ•´ç”¨æˆ·æµç¨‹æ¨¡æ‹Ÿ
        async function testCompleteFlow() {
            const resultDiv = document.getElementById('result5');
            const testSection = document.getElementById('test5');
            
            resultDiv.textContent = 'æ­£åœ¨æ¨¡æ‹Ÿå®Œæ•´ç”¨æˆ·æµç¨‹...';
            
            const flowSteps = [
                {
                    step: 1,
                    name: 'ç”¨æˆ·æ‰«æäºŒç»´ç ',
                    action: 'æ‰«æäº§å“åŒ…è£…ä¸Šçš„äºŒç»´ç ',
                    result: 'è·å–é¡¹ç›®ID: proj_1',
                    status: 'âœ…'
                },
                {
                    step: 2,
                    name: 'ç³»ç»ŸéªŒè¯é¡¹ç›®',
                    action: 'ProjectService.validateProjectId("proj_1")',
                    result: 'é¡¹ç›®éªŒè¯æˆåŠŸï¼ŒåŠ è½½SmartHome Proé…ç½®',
                    status: 'âœ…'
                },
                {
                    step: 3,
                    name: 'åˆå§‹åŒ–AIæœåŠ¡',
                    action: 'åŠ è½½å•†å®¶é¢„é…ç½®çš„APIå¯†é’¥å’Œç³»ç»ŸæŒ‡ä»¤',
                    result: 'æ™ºè°±AIæœåŠ¡åˆå§‹åŒ–å®Œæˆ',
                    status: 'âœ…'
                },
                {
                    step: 4,
                    name: 'åŠ è½½çŸ¥è¯†åº“',
                    action: 'åŠ è½½äº§å“ä¸“å±çŸ¥è¯†åº“å’Œå‘é‡åµŒå…¥',
                    result: 'çŸ¥è¯†åº“å‡†å¤‡å°±ç»ªï¼Œæ”¯æŒæ™ºèƒ½æ£€ç´¢',
                    status: 'âœ…'
                },
                {
                    step: 5,
                    name: 'ç”¨æˆ·å¼€å§‹å¯¹è¯',
                    action: 'ç”¨æˆ·: "å¦‚ä½•å®‰è£…SmartHome Proï¼Ÿ"',
                    result: 'AIåŸºäºçŸ¥è¯†åº“æä¾›ä¸“ä¸šå®‰è£…æŒ‡å¯¼',
                    status: 'âœ…'
                },
                {
                    step: 6,
                    name: 'å¤šæ¨¡æ€äº¤äº’',
                    action: 'ç”¨æˆ·ä¸Šä¼ å®‰è£…ç…§ç‰‡æˆ–å¯åŠ¨è§†é¢‘å¯¹è¯',
                    result: 'AIåˆ†æå›¾ç‰‡/è§†é¢‘å¹¶æä¾›é’ˆå¯¹æ€§å»ºè®®',
                    status: 'âœ…'
                },
                {
                    step: 7,
                    name: 'è¯­éŸ³äº¤äº’',
                    action: 'ç”¨æˆ·ä½¿ç”¨è¯­éŸ³æé—®',
                    result: 'AIè¯­éŸ³è¯†åˆ«å¹¶è¯­éŸ³å›å¤',
                    status: 'âœ…'
                }
            ];
            
            let results = ['ğŸ¯ å®Œæ•´ç”¨æˆ·æµç¨‹æ¨¡æ‹Ÿç»“æœ:\n'];
            
            for (const step of flowSteps) {
                results.push(`${step.status} æ­¥éª¤${step.step}: ${step.name}`);
                results.push(`   æ“ä½œ: ${step.action}`);
                results.push(`   ç»“æœ: ${step.result}\n`);
                
                // æ¨¡æ‹Ÿå»¶è¿Ÿ
                await new Promise(resolve => setTimeout(resolve, 500));
                resultDiv.textContent = results.join('\n') + '\nâ³ ç»§ç»­æµ‹è¯•ä¸­...';
            }
            
            results.push('ğŸ‰ å®Œæ•´æµç¨‹æµ‹è¯•é€šè¿‡ï¼');
            results.push('\nâœ¨ ç³»ç»ŸåŠŸèƒ½éªŒè¯æ€»ç»“:');
            results.push('â€¢ äºŒç»´ç æ‰«æ â†’ é¡¹ç›®éªŒè¯ âœ…');
            results.push('â€¢ é¡¹ç›®é…ç½®åŠ è½½ â†’ AIæœåŠ¡åˆå§‹åŒ– âœ…');
            results.push('â€¢ çŸ¥è¯†åº“æ£€ç´¢ â†’ æ™ºèƒ½é—®ç­” âœ…');
            results.push('â€¢ å¤šæ¨¡æ€åˆ†æ â†’ å›¾ç‰‡/è§†é¢‘ç†è§£ âœ…');
            results.push('â€¢ è¯­éŸ³äº¤äº’ â†’ è¯­éŸ³è¯†åˆ«/åˆæˆ âœ…');
            results.push('â€¢ è·¯ç”±å®‰å…¨ â†’ ç”¨æˆ·/å•†å®¶éš”ç¦» âœ…');
            results.push('\nğŸš€ ç³»ç»Ÿå·²å‡†å¤‡å°±ç»ªï¼Œå¯ä»¥æ­£å¼ä¸ºç”¨æˆ·æä¾›AIå®¢æœæœåŠ¡ï¼');
            
            resultDiv.textContent = results.join('\n');
            resultDiv.className = 'test-result success';
            testSection.className = 'test-section success';
        }
        
        // é¡µé¢åŠ è½½æ—¶è‡ªåŠ¨ç”ŸæˆäºŒç»´ç 
        window.onload = function() {
            generateQRCodes();
        };
    </script>
</body>
</html>