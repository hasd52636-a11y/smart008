# 用户隐私保护分析报告

## 🔒 用户扫码后记录的信息

### ✅ **当前记录的信息（最小化原则）**

| 信息类型 | 记录内容 | 存储位置 | 用途 | 隐私级别 |
|---------|---------|---------|------|---------|
| **项目ID** | 扫码的产品项目ID | URL参数 | 路由到对应产品服务 | 🟢 公开 |
| **对话内容** | 用户与AI的对话记录 | 组件状态（内存） | 当前会话显示 | 🟡 会话级 |
| **API密钥** | 商家预配置的智谱API密钥 | localStorage | AI服务调用 | 🔴 敏感 |

### ❌ **不记录的用户信息**

- ❌ 用户IP地址
- ❌ 用户设备信息
- ❌ 用户地理位置
- ❌ 用户身份信息
- ❌ 浏览器指纹
- ❌ Cookie追踪
- ❌ 用户行为分析
- ❌ 第三方追踪代码

## 🛡️ **安全隔离措施**

### 1. **路由安全隔离**

```typescript
// ✅ 用户端路由（完全隔离）
<Route path="/view/:projectId" element={<UserPreview />} />
<Route path="/video/:projectId" element={<VideoChat />} />

// ✅ 商家后台路由（需要明确路径）
<Route path="/merchant/*" element={<MerchantBackend />} />

// ✅ 默认路由（公共欢迎页面，绝不跳转到商家后台）
<Route path="*" element={<PublicWelcomePage />} />
```

**安全保证：**
- 用户扫码后只能访问 `/view/{projectId}` 或 `/video/{projectId}`
- 绝对无法访问 `/merchant/*` 商家后台路由
- 错误路径会显示公共欢迎页面，不会泄露商家信息

### 2. **数据存储安全**

```typescript
// ✅ 对话数据仅存储在组件状态（内存中）
const [messages, setMessages] = useState([]);

// ✅ 会话结束后自动清除，不持久化
// ✅ 不使用 localStorage 存储用户对话
// ✅ 不发送到第三方服务器
```

### 3. **API密钥安全**

```typescript
// ✅ 商家预配置，用户无感知
const savedApiKey = localStorage.getItem('zhipuApiKey');

// ✅ 仅用于AI服务调用，不暴露给用户
// ✅ 用户无法查看或修改API密钥
```

## 📊 **用户数据流向**

```
用户扫码 → 进入产品页面 → 开始对话
    ↓
对话内容 → 发送到智谱AI → 返回AI回复
    ↓
会话结束 → 数据自动清除 → 无持久化存储
```

**数据处理原则：**
- 🟢 **最小化收集**：只收集必要的对话内容
- 🟢 **临时存储**：数据仅在会话期间存在
- 🟢 **自动清除**：页面关闭后数据自动销毁
- 🟢 **不跨会话**：每次扫码都是全新会话

## 🚫 **绝对禁止的行为**

### 1. **路由安全**
- ❌ 绝对禁止用户跳转到商家后台
- ❌ 绝对禁止暴露商家管理界面
- ❌ 绝对禁止显示商家配置信息

### 2. **数据收集**
- ❌ 禁止收集用户个人身份信息
- ❌ 禁止追踪用户行为
- ❌ 禁止使用第三方分析工具
- ❌ 禁止持久化存储用户对话

### 3. **隐私泄露**
- ❌ 禁止记录用户设备信息
- ❌ 禁止获取用户位置信息
- ❌ 禁止使用Cookie追踪
- ❌ 禁止与其他系统共享用户数据

## ✅ **隐私保护措施**

### 1. **技术措施**
- 🔒 路由级别的安全隔离
- 🔒 内存级别的数据存储
- 🔒 会话级别的数据生命周期
- 🔒 API密钥的安全管理

### 2. **设计原则**
- 🛡️ 隐私优先设计
- 🛡️ 数据最小化原则
- 🛡️ 透明度原则
- 🛡️ 用户控制原则

### 3. **合规性**
- 📋 符合《个人信息保护法》
- 📋 符合《数据安全法》
- 📋 符合《网络安全法》
- 📋 符合GDPR基本要求

## 🔍 **代码审计结果**

### UserPreview.tsx
```typescript
// ✅ 仅读取商家预配置的API密钥
const savedApiKey = localStorage.getItem('zhipuApiKey');

// ✅ 对话数据仅存储在组件状态
const [messages, setMessages] = useState([]);

// ✅ 无用户追踪代码
// ✅ 无第三方分析工具
// ✅ 无Cookie设置
```

### VideoChat.tsx
```typescript
// ✅ 仅用于AI服务连接
const savedApiKey = localStorage.getItem('zhipuApiKey');

// ✅ 视频数据仅用于实时通信
// ✅ 不录制或存储视频内容
// ✅ 摄像头权限仅在会话期间使用
```

## 📝 **隐私声明建议**

建议在用户界面添加简洁的隐私说明：

```
🔒 隐私保护承诺
• 我们不收集您的个人信息
• 对话内容仅用于当前技术支持
• 会话结束后数据自动清除
• 符合国家数据安全法规要求
```

## 🎯 **总结**

**用户扫码后记录的信息：**
1. **项目ID**（用于路由）
2. **当前对话内容**（临时存储，会话结束自动清除）
3. **商家API密钥**（预配置，用户无感知）

**安全保证：**
- ✅ 绝对不会跳转到商家后台
- ✅ 完全的路由安全隔离
- ✅ 最小化数据收集
- ✅ 临时数据存储
- ✅ 符合隐私保护法规

用户可以放心使用扫码服务，系统设计完全符合隐私保护要求。